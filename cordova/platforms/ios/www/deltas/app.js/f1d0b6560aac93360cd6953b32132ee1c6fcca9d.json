["function _2a6b21f2a429b2d476fbf8cd4ec7bba71ab91b2f",50,1383,"client){Instinct.controller.client={}}if(!Instinct.controller.main){Instinct.controller.main",1405,504,"var settings=settings||{};var sqlite=sqlite||{};",1909,525198,"controller.client.settings",531104,32,"getSetting:function(a){if(a in settings.settings){return settings.settings[a]}else{return false}},setSetting:function(a,c,b){if(window.sqlitePlugin){sqlite.getRows(\"settings\",[\"key\"],[a],function(d){if(d){sqlite.updateRow(\"settings\",d[0].id,[\"key\",\"value\"],[a,c],function(e){b()})}else{sqlite.insertRow(\"settings\",[\"key\",\"value\"],[a,c],function(e){b()})}settings.settings[a]=c})}else{localStorage.setItem(a,c);b()}},loadSettings:function(a){if(window.cordova&&window.sqlitePlugin){settings={loadSettings:this.loadSettings,get:this.getSetting,set:this.setSetting,removeAll:this.removeAll,settings:{}};sqlite.createTable(\"settings\",[\"key\",\"value\"],[\"text\",\"text\"],function(){sqlite.query(\"SELECT * FROM Settings\",[],function(b){data=sqlite.fetch(b);settings.settings={};Ext.each(data,function(c){settings.settings[c.key]=c.value});a(settings.settings)})})}else{settings={loadSettings:function(b){b()},get:function(c){var b=localStorage.getItem(c);if(b===null&&typeof b===\"object\"){return false}else{return b}},set:function(b,d,c){localStorage.setItem(b,d);if(typeof c==\"function\"){c()}return false},removeAll:function(b){b();return true}};a(settings.settings);if(window.cordova){Ext.Msg.alert(false,\"ERROR: SQLITE PLUGIN NOT WORKING!\")}}},removeAll:function(a){if(window.sqlitePlugin){sqlite.query(\"DELETE FROM Settings\",[],function(b){a()})}},prepSettings:function(){console.log(\"settings done\");this.settings={};Ext.define(\"settings\",{singleton:true,loadSettings:this.loadSettings,get:this.getSetting,set:this.setSetting});console.log(this)",530592,35,".client,\"settings",525997,33,527107,364,"image\",cls:\"menuIcon\",width:50,src:\"resources/images/icons/profile.png",527502,168,"image\",cls:\"menuIcon\",width:50,src:\"resources/images/icons/map.png",527502,51,527748,115,"image\",cls:\"menuIcon\",width:50,src:\"resources/images/icons/inventory.png",527502,51,527947,125,"image\",cls:\"menuIcon\",width:50,src:\"resources/images/icons/friends.png",527502,51,528154,118,"image\",cls:\"menuIcon\",width:50,src:\"resources/images/icons/chat.png",527502,51,528351,116,"image\",cls:\"menuIcon\",width:50,src:\"resources/images/icons/messages.png",527502,51,528550,124,"image\",cls:\"menuIcon\",width:50,src:\"resources/images/icons/settings.png",527502,51,528757,122,"image\",cls:\"menuIcon\",width:50,src:\"resources/images/icons/logout.png",527502,51,528960,896,"settings.set(\"userId\",e.id);settings.set(\"userToken\",e.token",529934,167,"false,",530101,51,"false,",531691,45,530197,59,"false,\"Login Failure\"",530273,1186,"c=settings.get(\"userId\");var d=settings.get(\"userToken\");if(c===false||d===false){b(false)}else{var a=function(h,g){if(h.status===200){var f=Ext.JSON.decode(h.responseText);if(f.errorHandle==\"alert\"){if(f.errorText!==\"\"){Ext.Msg.alert(false,f.errorText)}if(f.successText!==\"\"){Ext.Msg.alert(false,f.successText)}}if(f.success===true){b(true)}else{",531662,90,"e=function(g,f",531766,208,"c,token:d},success:a,failure:e}",530590,37,532050,784,"false,",532834,34,"false,",532868,1081,"controller.nativeFunctions.Sqlite",531104,32,"query:function(c,d,a,b){if(typeof a!==\"function\"){a=function(f){console.log(\"Query success: \"+c,d)}}if(typeof b!==\"function\"){b=function(f){console.log(f.message,c,d)}}sqlite.database.executeSql(c,d,a,b)},fetch:function(a){var c=[];for(var b=0;b<a.rows.length;b++){c.push(a.rows.item(b))}return c},getRows:function(b,f,d,a,c){var e=[];Ext.each(f,function(h,g){e.push(\"`\"+h+\"` = ?\")});fields=e.join(\" AND \");if(f.length>0){whereString=\" WHERE \"+fields}else{whereString=\"\"}sqlite.query(\"SELECT * FROM `\"+b+\"`\"+whereString,d,function(g){if(g.rows.length>0){a(sqlite.fetch(g))}else{a(false)}},c)},createTable:function(c,f,d,a,b){var e=[];Ext.each(f,function(h,g){if(d[g]){fieldType=d[g]}else{fieldType=\"text\"}e.push(\"`\"+h+\"` \"+fieldType)});if(e.length){fields=\",\"+e.join(\", \")}else{fields=\"\"}sqlite.query(\"CREATE TABLE IF NOT EXISTS `\"+c+\"` (`id` INTEGER PRIMARY KEY\"+fields+\");\",[],a,b)},insertRow:function(b,f,d,a,c){var e=[];Ext.each(f,function(h,g){e.push(\"`\"+h+\"`\")});fields=e.join(\", \");var e=[];Ext.each(d,function(h,g){e.push(\"?\")});values=e.join(\", \");sqlite.query(\"INSERT INTO `\"+b+\"` (\"+fields+\") VALUES (\"+values+\");\",d,function(g){a(g.insertId)},c)},updateRow:function(b,g,f,d,a,c){var e=[];Ext.each(f,function(i,h){e.push(\"`\"+i+\"` = ?\")});fields=e.join(\", \");d.push(g);sqlite.query(\"UPDATE `\"+b+\"` SET \"+fields+\" WHERE `id` = ?;\",d,function(){a(g)},c)},openDatabase:function(a){if(window.cordova&&window.sqlitePlugin){Ext.define(\"sqlite\",{singleton:true,insertRow:this.insertRow,updateRow:this.updateRow,getRows:this.getRows,query:this.query,createTable:this.createTable,fetch:this.fetch});window.sqlitePlugin.openDatabase({name:\"database.sqlite\",location:2,androidDatabaseImplementation:2},function(b){sqlite.database=b;a()})}else{console.log(\"ERROR: SQLITE PLUGIN NOT FOUND!\");if(window.cordova){Ext.Msg.alert(false,\"ERROR: SQLITE PLUGIN NOT FOUND!\")}a(",530590,37,".nativeFunctions,\"Sqlite",525997,33,"controller.client.database",531104,32,"createTables:function(a){if(window.cordova&&window.sqlitePlugin){this.checkUpdateTables();this.setSenchaStores();a()}else{a()}},setSenchaStores:function(){},deleteDatabase:function(a){window.sqlitePlugin.deleteDatabase({name:\"database.sqlite\",location:\"default\"},function(e){console.log(e)},function(e){console.log(e)});var d=Ext.StoreManager.removeAll();for(var b=0;b<d.length;b++){var c=d.keys[b];Ext.getStore(c).destroy()}window.localStorage.clear();a()},checkUpdateTables:function(){",530592,35,".client,\"database",525997,33,"controller.main.Menu",530937,66,529144,43,533949,1008,",\"client.settings\",\"nativeFunctions.Sqlite\",\"client.database\",\"main.Menu",534956,140,535254,39,"d=\"\";var c=function(e){Instinct.app.getController(\"client.settings\").loadSettings(e)};var b=function(e){Instinct.app.getController(\"client.database\").createTables(e)};var a=function(){d=Ext.widget(\"instinctMain\");var e",535361,54,"var f=settings.get(\"userId\");var g=settings.get(\"userToken\");console.log(\"checking player data [\"+f+\"] [\"+g+\"]\");if(f===false||g===false){d=Ext.widget(\"instinctMain\");viewport.add(d)}else{e.checkToken(function(h){if(h===true){d=Ext.widget(\"mainMenu\");viewport.add(d)}else{d=Ext.widget(\"instinctMain\");viewport.add(d)}})}",535112,141,533028,44,"Sqlite\").openDatabase(function(){c(function(){b(function(){a()})})})}}",526448,33,535624,740]